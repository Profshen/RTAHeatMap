<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
    <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet/v1.0.0-rc.1/leaflet.css" />
<script src="http://cdn.leafletjs.com/leaflet/v1.0.0-rc.1/leaflet.js"></script> 

<style> 
.info {
    padding: 6px 8px;
    font: 14px/16px Arial, Helvetica, sans-serif;
    background: white;
    background: rgba(255,255,255,0.8);
    box-shadow: 0 0 15px rgba(0,0,0,0.2);
    border-radius: 5px;
}

.legend {
  text-align: left;
  line-height: 18px;
  color: #555;
}
.legend i {
  width: 18px;
  height: 18px;
  float: left;
  margin-right: 8px;
  opacity: 0.7;
}

</style> 
   </head>
  <script src="http://code.jquery.com/jquery-2.1.0.min.js"></script>
 
<body>
 <div id="mapid" style="width: 80%; height: 600px; border: 1px solid #ccc;"></div>

<script>


        var basemap = new L.TileLayer('http://{s}.tiles.mapbox.com/v3/skorasaurus.e5ff1f07/{z}/{x}/{y}.png', {maxZoom: 20});
                var latlng = new L.LatLng(41.4118,-81.71);
                
                var themap = new L.Map('mapid', {center: latlng, zoom: 10.5, layers: [basemap]});


        function t3hStyle(thefeature) {
                return { 
                    stroke: false, 
                    weight: 1.02,
                    opacity: 0.54,
                    // color: 'gray',
                    // fillColor: '#800026',
                    fillColor: getFillColor(thefeature.properties.index), 
                    fillOpacity: 0.7
                }
        }

       
       function getFillColor(deez) {
         console.log("input of deez is" + deez)
                  if (deez === 0) {
                    return '#e6e2ed'; 
                  }
                  else if (deez === 1) {
                    return '#ced5e8'; 
                  }
                  else if (deez === 2) {
                    return '#a4bedb'; 
                  }
                  else if (deez === 3) {
                    return '#4395c3'; 
                  }
                  else if (deez === 4) {
                    return '#1d7bad'; 
                  }
                  return '#045a8d'
        }           


              // for others to get a brief update of why I'm using jquery see http://lyzidiamond.com/posts/external-geojson-and-leaflet-the-other-way      
    $.getJSON("data/contours-v7-simplified5.geojson", function(data) {
        var thegeojson = L.geoJson(data, {
            style: t3hStyle,
            onEachFeature: function (tefeature, telayer) {
              telayer.bindPopup("this is in the" + tefeature.properties.index + " quintile")
              }
        }) 
    thegeojson.addTo(themap);  
    }); 
      

  var thelegend = L.control({position: 'bottomright'});
     
 
  thelegend.onAdd = function (map) {

      var div = L.DomUtil.create('div', 'info legend'),
        grades = [0, 1, 2, 3, 4],
        breakValues = [0, 5, 10, 15, 20], 
        labels = [],
        from, to; 

      for (var i = 0; i < grades.length; i++) {
        from = breakValues[i];
        to = breakValues[i+1];
       // to = breakValues[grades[i+1]];
        labels.push(
          '<i style="background:' + getFillColor(grades[i]) + '"></i> ' +
          from + (to ? '&ndash;' + to : '+'));
      }

      div.innerHTML = labels.join('<br>');
      return div;
  };

thelegend.addTo(themap);


            </script>
        
        

</body>
</html>